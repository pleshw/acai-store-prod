class BagBuilder{static _items=[];static get items(){return BagBuilder._items}static set items(arrItems){this._items=arrItems;BagBuilder.resetBagComponent()}static addItem(item){BagBuilder._items.push(item);BagBuilder.resetBagComponent()}static removeItem(item){BagBuilder.removeItemById(item.id)}static changeItemByIndex(itemIndex,newItem){BagBuilder._items[itemIndex]=newItem;BagBuilder.resetBagComponent()}static removeItemById(itemId){const itemIndex=BagBuilder._items.findIndex(i=>i.id===itemId);if(itemIndex===-1){throw new Error(`Invalid item at ${this.name}.`)}BagBuilder._items.splice(itemIndex,1);BagBuilder.resetBagComponent()}static resetBagComponent(){BagBuilder.resetBagInfoComponent();BagBuilder.resetBagPriceComponent()}static resetBagPriceComponent(){const elementBagTotalPrice=document.getElementById("bagTotalPrice");if(elementBagTotalPrice){elementBagTotalPrice.innerHTML=formatItemPrice(BagBuilder.totalPrice)}}static resetBagInfoComponent(){const elementOffcanvasBagInfo=document.getElementById("offcanvasBagInfo");if(elementOffcanvasBagInfo){elementOffcanvasBagInfo.innerHTML="";BagBuilder._items.forEach(i=>{elementOffcanvasBagInfo.insertAdjacentHTML("beforeend",templateItemOffcanvasBagInfo(i))})}}static get itemsDetails(){return BagBuilder.items.map(i=>i.item)}static get totalPrice(){if(!BagBuilder._items||BagBuilder._items.length<1){return 0}let arrAddonsPrices=BagBuilder.items.map(a=>a.price);return arrAddonsPrices.reduce((acc,next)=>acc+next,0)}static get addons(){if(!this.addons||this.addons.length<1){return 0}let arrAddonsPrices=this.items.map(a=>a.price);return arrAddonsPrices.reduce((acc,next)=>acc+next,0)}static reset(){this.items=[]}static buildAndReset(){const result=this.build();this.reset();return result}}function formatItemPrice(numItemPrice){return numItemPrice.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}).replaceAll(" ","")}function makeInputSearchShowcase(inputId){const inputElement=document.getElementById(inputId);if(!inputElement){throw new Error("Invalid input element.")}inputElement.addEventListener("input",function(){var searchTerm=this.value.trim().toLowerCase().replaceAll(" ","");var arrElementItemShowCase=Array.from(document.querySelectorAll(".item-showcase"));arrElementItemShowCase.forEach(function(itemCardElement){const titleContainsSearchTerm=itemCardElement.querySelector(".item-showcase-name").innerHTML.toLowerCase().replaceAll(" ","").includes(searchTerm);const descriptionContainsSearchTerm=itemCardElement.querySelector(".item-showcase-description").innerHTML.toLowerCase().replaceAll(" ","").includes(searchTerm);if(titleContainsSearchTerm||descriptionContainsSearchTerm){itemCardElement.classList.remove("d-none")}else{itemCardElement.classList.add("d-none")}})});inputElement.addEventListener("input",function(event){if(event.inputType==="deleteContentBackward"||event.inputType==="deleteContentForward"){if(this.value.trim()===""){var elementos=document.querySelectorAll("#elementos > div");elementos.forEach(function(elemento){elemento.classList.remove("d-none")})}}})}function resetModalItemCount(modalId,itemBuilder){const spanAmountSelectedItem=document.getElementById(`${modalId}Amount`);if(spanAmountSelectedItem){spanAmountSelectedItem.innerHTML=itemBuilder.amount}const buttonDecreaseItemCount=document.getElementById(`${modalId}DecreaseItemCount`);const buttonIncreaseItemCount=document.getElementById(`${modalId}IncreaseItemCount`);if(!buttonIncreaseItemCount||!buttonDecreaseItemCount){throw new Error(`Invalid element at ${this.name}`)}if(itemBuilder.amount===1){buttonDecreaseItemCount.setAttribute("disabled","")}else{buttonDecreaseItemCount.removeAttribute("disabled")}}function resetModalItemPrice(modalId,itemBuilder){const spanModalPrice=document.getElementById(`${modalId}Price`);if(!spanModalPrice){throw new Error(`Invalid element at ${this.name}`)}if(itemBuilder.details&&itemBuilder.details.price){spanModalPrice.innerHTML=formatItemPrice(itemBuilder.totalPrice)}else{spanModalPrice.innerHTML=formatItemPrice(0)}}function setModalCurrentItem(modalId,itemBuilder){resetModalItemCount(modalId,itemBuilder);resetModalItemPrice(modalId,itemBuilder);const uniqueAddonsOnBuilder=[...new Set(itemBuilder.addons)];uniqueAddonsOnBuilder.forEach(a=>itemCountRegulatorSetAmountByAddon(modalId,itemBuilder,a,0,a.maxLimit??10));const arrFillings=[...itemBuilder.fillings];multipleSelectCheckboxUncheckAllByModalId(modalId);arrFillings.forEach(f=>multipleSelectCheckboxSetFillingCheck(modalId,itemBuilder,f))}function addOrderDetailsForItem(modalId,itemName){const h1ModalTitle=document.getElementById(`${modalId}Title`);const spanModalPrice=document.getElementById(`${modalId}Price`);if(!modalItemSelectTitle||!spanModalPrice){throw new Error(`Invalid element at ${this.name}`)}modalItemSelectItemBuilder.details=dictItemsByName.get(itemName);h1ModalTitle.innerHTML=itemName+`<small class="fw-lighter user-select-none"><i>${modalItemSelectItemBuilder.details.freeAddons>1?` - Você pode selecionar até ${modalItemSelectItemBuilder.details.freeAddons} adicionais gratuitamente!</i></small>`:``}`;spanModalPrice.innerHTML=formatItemPrice(modalItemSelectItemBuilder.totalPrice)}function addOrderDetailsForEditItem(modalId,itemId){const h1ModalTitle=document.getElementById(`${modalId}Title`);const spanModalPrice=document.getElementById(`${modalId}Price`);const buttonConfirmItemEdit=document.getElementById(`${modalId}ButtonConfirm`);if(!modalItemSelectTitle||!spanModalPrice||!buttonConfirmItemEdit){throw new Error(`Invalid element at ${this.name}`)}const itemIndex=BagBuilder._items.findIndex(i=>i.id===itemId);if(itemIndex===-1){throw new Error(`Invalid item on ${this.name}.`)}modalItemEditItemBuilder.setCurrentItem(BagBuilder.items[itemIndex]);h1ModalTitle.innerHTML=modalItemEditItemBuilder.details.name+`<small class="fw-lighter user-select-none"><i>${modalItemEditItemBuilder.details.freeAddons>1?` - Você pode selecionar até ${modalItemEditItemBuilder.details.freeAddons} adicionais gratuitamente!</i></small>`:``}`;spanModalPrice.innerHTML=formatItemPrice(modalItemEditItemBuilder.totalPrice);buttonConfirmItemEdit.setAttribute("onclick",`editItemByIndex('${modalId}',${itemIndex})`)}function editItemByIndex(modalId,itemIndex){const buttonConfirmItemEdit=document.getElementById(`${modalId}ButtonConfirm`);BagBuilder.changeItemByIndex(itemIndex,modalItemEditItemBuilder.buildAndReset());buttonConfirmItemEdit.removeAttribute("onclick")}function setHTMLProducts(){const divCoposSection1=document.getElementById("coposCustomizaveis");if(!divCoposSection1){throw new Error(`Invalid element at ${this.name}`)}dictItemsByName.forEach((val,key)=>divCoposSection1.insertAdjacentHTML("beforeend",templateStoreItem("modalItemSelect",key,val)))}function resetButtonsMultipleSelect(modalId,elementId,checkedByDefault=false){const inputItemSelect=document.getElementById(`${modalId}AddonsItem${elementId}`);if(!inputItemSelect){throw new Error(`Invalid element at ${this.name}`)}inputItemSelect.checked=checkedByDefault}function multipleSelectCheckboxUncheckAllByModalId(modalId){dictAddonsByName.forEach((val,key)=>{if(val.sectionType==="multipleSelect"){resetButtonsMultipleSelect(modalId,val.id,false)}})}function multipleSelectCheckboxSetFillingCheck(modalId,modalItemBuilder,addon){const checkboxElement=document.getElementById(`${modalId}AddonsItem${addon.id}`);if(!checkboxElement){return}const tmpCurrentFillingCount=Array.from(modalItemBuilder.fillings).findIndex(a=>a.id===addon.id);if(tmpCurrentFillingCount!==-1){checkboxElement.checked=true}}function multipleSelectCheckboxSetListeners(modalId,modalItemBuilder,addon){const checkboxElement=document.getElementById(`${modalId}AddonsItem${addon.id}`);if(!checkboxElement){return}multipleSelectCheckboxSetFillingCheck(modalId,modalItemBuilder,addon);checkboxElement.addEventListener("change",function(){if(this.checked){modalItemBuilder.fillings.add(addon)}else{modalItemBuilder.fillings.delete(addon)}})}function setHTMLAddonsSections(modalId,modalItemBuilder){const divAddonsSections=document.getElementById(`${modalId}Addons`);if(!divAddonsSections){throw new Error(`Invalid element at ${this.name}`)}dictAddonsByName.forEach((val,itemName)=>{const divCurrentAddonSection=document.getElementById(`${modalId}AddonsSection${val.section}`);if(!divCurrentAddonSection){divAddonsSections.insertAdjacentHTML("beforeend",getTemplateAddonSectionByItemName(modalId,itemName))}const divAddonsContainer=document.getElementById(`${modalId}AddonsSectionItems${val.section}`);if(!divAddonsContainer){throw new Error(`Invalid element at ${this.name}`)}divAddonsContainer.insertAdjacentHTML("beforeend",getAddonTemplateByItemName(modalId,itemName));switch(val.sectionType){case"counter":itemCountRegulatorSetListeners(modalId,modalItemBuilder,val,0,val.maxLimit??10);break;case"multipleSelect":multipleSelectCheckboxSetListeners(modalId,modalItemBuilder,val);if(val.checked){modalItemBuilder.fillings.add(val)}break;default:itemCountRegulatorSetListeners(modalId,modalItemBuilder,val,0,val.maxLimit??10);break}})}class ItemBuilder{constructor({onInit=()=>{},onAmountChange=newValue=>{},onItemChange=newItem=>{}}){this.details=null;this._amount=1;this.fillings=new Set;this.addons=[];this.onAmountChange=onAmountChange.bind(this);this.onItemChange=onItemChange.bind(this);onInit.bind(this)()}setCurrentItem(val){this.details=val.details;this._amount=val.amount;this.fillings=val.fillings;this.addons=val.addons;this.onItemChange(this.build())}get amount(){return this._amount}set amount(val){if(val<1){return}this._amount=val;this.onAmountChange(this._amount)}get totalPrice(){if(!this.details||!this.details.price){return 0}let currentItemPrice=this.details.price;currentItemPrice+=this.addonsPrice;return currentItemPrice*this._amount}get addonsPrice(){if(!this.addons||this.addons.length<1){return 0}let arrAddonsPrices=this.addons.map(a=>a.price);if(this.details.freeAddons&&this.details.freeAddons>0){const arrCurrentAddonsPriceSorted=arrAddonsPrices.sort().reverse();arrCurrentAddonsPriceSorted.splice(0,this.details.freeAddons);arrAddonsPrices=arrCurrentAddonsPriceSorted}return arrAddonsPrices.reduce((acc,next)=>acc+next,0)}get addonsPriceIncludeFreeAddons(){if(!this.addons||this.addons.length<1){return 0}let arrAddonsPrices=this.addons.map(a=>a.price);return arrAddonsPrices.reduce((acc,next)=>acc+next,0)}reset(){this.amount=1;this.details=null;this.addons=[];this.fillings=new Set;this.onItemChange(this.build())}build(){const result={id:getItemUniqueId(),details:this.details,amount:this.amount,addons:this.addons,fillings:this.fillings,price:this.totalPrice,addonsPrice:this.addonsPrice,freeAddonsPrice:this.addonsPriceIncludeFreeAddons-this.addonsPrice};return result}buildAndReset(){const result=this.build();this.reset();return result}}function getItemUniqueId(){const randomNumber=Math.random().toString(36).slice(2,11);const timestamp=(new Date).getTime();return`${randomNumber}-${timestamp}`}const defaultItemImage="https://flordejambu.com/wp-content/uploads/2022/05/acai.png";const dictItemsByName=new Map([["300ml",{name:"300ml",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",description:"Copo de 300ml com 3 adicionais grátis",price:11,freeAddons:3}],["400ml",{name:"400ml",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",description:"Copo de 400ml com 3 adicionais grátis",price:15,freeAddons:3}],["500ml",{name:"500ml",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",description:"Copo de 500ml com 4 adicionais grátis",price:20,addonsMaxLimit:12,freeAddons:4}],["700ml",{name:"700ml",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",description:"Copo de 700ml com 4 adicionais grátis",price:26,addonsMaxLimit:15,freeAddons:4}]]);const dictAddonsByName=new Map([["Açaí",{id:"Acai",name:"Açaí",section:"Açaí",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:true,price:0}],["Creme de Ninho",{id:"CremeDeNinho",name:"Creme de Ninho",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Creme de cupuaçu",{id:"CremeDeCupuaçu",name:"Creme de cupuaçu",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Creme mix",{id:"CremeMix",name:"Creme mix",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Creme de Oreo",{id:"CremeDeOreo",name:"Creme de Oreo",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Creme de tapioca",{id:"CremeDeTapioca",name:"Creme de tapioca",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Cookies cream",{id:"CookiesCream",name:"Cookies cream",section:"Cremes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Impacto (Chocolate com castanha)",{id:"ImpactoChocolateComCastanha",name:"Impacto",infoTitle:"Chocolate com castanha",displayName:"<span>Impacto</span>",section:"Sorvetes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Chocolate",{id:"Chocolate",name:"Chocolate",section:"Sorvetes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Napolitano",{id:"Napolitano",name:"Napolitano",section:"Sorvetes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Morango",{id:"Morango",name:"Morango",section:"Sorvetes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Pavê",{id:"Pavê",name:"Pavê",section:"Sorvetes",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"multipleSelect",checked:false,price:0}],["Leite em pó",{id:"LeiteEmPó",name:"Leite em pó",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Amendoim",{id:"Amendoim",name:"Amendoim",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Amendoim triturado",{id:"AmendoimTriturado",name:"Amendoim triturado",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Paçoca",{id:"Paçoca",name:"Paçoca",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Granola",{id:"Granola",name:"Granola",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Choco ball",{id:"ChocoBall",name:"Choco ball",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Choco power",{id:"ChocoPower",name:"Choco power",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Disquete",{id:"Disquete",name:"Disquete",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Farinha láctea",{id:"FarinhaLáctea",name:"Farinha láctea",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Marshmallow",{id:"Marshmallow",name:"Marshmallow",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Ovomaltine",{id:"Ovomaltine",name:"Ovomaltine",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Jujubas",{id:"Jujubas",name:"Jujubas",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Gotas de Chocolate",{id:"GotasDeChocolate",name:"Gotas de Chocolate",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Castanha",{id:"Castanha",name:"Castanha",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Extras",price:.5}],["Chocolate",{id:"Chocolate",name:"Chocolate",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Morango",{id:"Morango",name:"Morango",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Kiwi",{id:"Kiwi",name:"Kiwi",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Leite condensado",{id:"LeiteCondensado",name:"Leite condensado",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Pasta de ninho",{id:"PastaDeNinho",name:"Pasta de ninho",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Pasta de avelã",{id:"PastaDeAvelã",name:"Pasta de avelã",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Coberturas",maxLimit:1,price:.5}],["Banana",{id:"Banana",name:"Banana",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Frutas",price:.5}],["Morango",{id:"Morango",name:"Morango",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Frutas",price:.5}],["Cereja",{id:"Cereja",name:"Cereja",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Frutas",price:.5}],["Kiwi",{id:"Kiwi",name:"Kiwi",img:"https://flordejambu.com/wp-content/uploads/2022/05/acai.png",sectionType:"counter",checked:false,section:"Frutas",price:.5}]]);function templateItemCountRegulator(parentId,elementId,hasBorders=true){return`
    <div style="width: 90px !important; max-width: 90px !important; box-sizing: border-box;"
      class="modal-button row p-0 m-0 user-select-none ${hasBorders?"border":""} justify-content-center align-items-center">
      <button style="transform: scale(.8)" id="${parentId}ItemCountRegulatorDecreaseItemCount${elementId}" type="button" tabindex="0"
        class="col-2 m-0 p-0 d-flex justify-content-center align-items-center btn border-0" aria-hidden="false"
        aria-label="Reduzir quantidade" disabled=""><span>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="#f00290" fill-rule="evenodd"
              d="M17.993 11c.556 0 1.007.444 1.007 1 0 .552-.45 1-1.007 1H6.007A1.001 1.001 0 0 1 5 12c0-.552.45-1 1.007-1h11.986z">
            </path>
          </svg>
        </span>
      </button>
      <span id="${parentId}ItemCountRegulatorCounter${elementId}" class="col-6 text-center user-select-none">0</span>
      <button style="transform: scale(.8)" id="${parentId}ItemCountRegulatorIncreaseItemCount${elementId}" type="button" tabindex="0"
        class="col-2 m-0 p-0 d-flex justify-content-center align-items-center btn border-0" aria-hidden="false"
        aria-label="Aumentar quantidade">
        <span>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="#f00290" fill-rule="evenodd"
              d="M13 11h4.993c.556 0 1.007.444 1.007 1 0 .552-.45 1-1.007 1H13v4.993C13 18.55 12.556 19 12 19c-.552 0-1-.45-1-1.007V13H6.007A1.001 1.001 0 0 1 5 12c0-.552.45-1 1.007-1H11V6.007C11 5.45 11.444 5 12 5c.552 0 1 .45 1 1.007V11z">
            </path>
          </svg>
        </span>
      </button>
    </div>
  `}function resetButtonsItemCountRegulator(parentId,addon,newValue,minValue=0,maxValue=10){const spanAmountSelectedItem=document.getElementById(`${parentId}ItemCountRegulatorCounter${addon.id}`);if(spanAmountSelectedItem){spanAmountSelectedItem.innerHTML=newValue.toString()}const buttonDecreaseItemCount=document.getElementById(`${parentId}ItemCountRegulatorDecreaseItemCount${addon.id}`);const buttonIncreaseItemCount=document.getElementById(`${parentId}ItemCountRegulatorIncreaseItemCount${addon.id}`);if(!buttonIncreaseItemCount||!buttonDecreaseItemCount){throw new Error(`Invalid element at ${this.name}.`)}if(newValue===minValue){buttonDecreaseItemCount.setAttribute("disabled","")}else{buttonDecreaseItemCount.removeAttribute("disabled")}if(newValue===maxValue){buttonIncreaseItemCount.setAttribute("disabled","")}else{buttonIncreaseItemCount.removeAttribute("disabled")}}function itemCountRegulatorSetAmountByAddon(parentId,itemBuilder,addon,minValue=0,maxValue=10){const tmpCurrentAddonCount=itemBuilder.addons.filter(a=>a.id===addon.id);if(itemBuilder.addons.length>0){resetButtonsItemCountRegulator(parentId,addon,tmpCurrentAddonCount.length,minValue,maxValue)}}function itemCountRegulatorSetListeners(parentId,itemBuilder,addon,minValue=0,maxValue=10){const buttonDecreaseItemCount=document.getElementById(`${parentId}ItemCountRegulatorDecreaseItemCount${addon.id}`);const buttonIncreaseItemCount=document.getElementById(`${parentId}ItemCountRegulatorIncreaseItemCount${addon.id}`);if(!buttonDecreaseItemCount||!buttonIncreaseItemCount){throw new Error(`Invalid element at ${this.name}.`)}itemCountRegulatorSetAmountByAddon(parentId,itemBuilder,addon,minValue,maxValue);buttonDecreaseItemCount.addEventListener("click",()=>{const spanAmountSelectedItem=document.getElementById(`${parentId}ItemCountRegulatorCounter${addon.id}`);let currentItemAmount=+spanAmountSelectedItem.innerHTML;currentItemAmount--;if(currentItemAmount<minValue){currentItemAmount=minValue}resetButtonsItemCountRegulator(parentId,addon,currentItemAmount,minValue,maxValue);const addonIndex=itemBuilder.addons.findIndex(a=>a.id===addon.id);if(addonIndex===-1){throw new Error(`Invalid element at ${this.name}.`)}itemBuilder.addons.splice(addonIndex,1);resetModalItemPrice(parentId,itemBuilder)});buttonIncreaseItemCount.addEventListener("click",()=>{const currentItemAddonsLimit=itemBuilder.details.addonsMaxLimit??10;if(itemBuilder.addons.length>=currentItemAddonsLimit){alert(`O máximo de adicionais que conseguimos colocar nesse item é ${currentItemAddonsLimit}.`);return}const spanAmountSelectedItem=document.getElementById(`${parentId}ItemCountRegulatorCounter${addon.id}`);let currentItemAmount=+spanAmountSelectedItem.innerHTML;currentItemAmount++;if(currentItemAmount>maxValue){currentItemAmount=maxValue}resetButtonsItemCountRegulator(parentId,addon,currentItemAmount,minValue,maxValue);itemBuilder.addons.push(addon);resetModalItemPrice(parentId,itemBuilder)})}function setupModalBuildItem(modalId,itemBuilder){const modalItemBuild=document.getElementById(modalId);modalItemBuild.addEventListener("show.bs.modal",event=>{dictAddonsByName.forEach((val,key)=>{switch(val.sectionType){case"counter":break;case"multipleSelect":if(val.checked){itemBuilder.fillings.add(val)}break;default:break}})});modalItemBuild.addEventListener("hidden.bs.modal",()=>{itemBuilder.reset();dictAddonsByName.forEach((val,key)=>{switch(val.sectionType){case"counter":resetButtonsItemCountRegulator(modalId,val,0);break;case"multipleSelect":resetButtonsMultipleSelect(modalId,val.id,val.checked);break;default:resetButtonsItemCountRegulator(modalId,val,0);break}})})}function templateStoreItem(modalToTriggerId,itemName,itemInfo){return`
  <div id="itemShowcase${itemName}" onclick="addOrderDetailsForItem('${modalToTriggerId}', '${itemName}')" class="item-showcase col-12 col-lg-3 col-xl-3 p-0 pointer mb-4 d-flex justify-content-center" data-bs-toggle="modal" data-bs-target="#${modalToTriggerId}">
    <div class="col-12 col-lg-11 col-xl-11 m-0 p-0 px-3 px-lg-0 px-xl-0 d-flex flex-wrap justify-content-center">
      <div class="pointer card acai-card shadow shadow-sm rounded-0 w-100">
        <img src="${itemInfo.img??defaultItemImage}" style="height: 270px;"
          class="card-img-top rounded-0 border-0 outline-0">
        <div class="card-body" style="height: 150px;">
          <h4 id="itemShowcaseName${itemName}" class="card-title item-showcase-name fw-bolder text-purple2">${itemName}</h4>
          <p id="itemShowcaseDescription${itemName}" class="card-text item-showcase-description text-muted">
            ${itemInfo.description}
          </p>
          <p class="card-text text-success" id="itemShowcasePrice${itemName}"><u><b><small>${formatItemPrice(itemInfo.price)}</small></b></u></p>
        </div>
        <div class="card-footer text-body-secondary">
          ${itemInfo.alert??"<small>Clique para escolher os acompanhamentos</small>"}
        </div>
      </div>
    </div>
  </div>
  `}function getTemplateAddonSectionByItemName(parentId,itemName){if(!dictAddonsByName.has(itemName)){return""}const addon=dictAddonsByName.get(itemName);switch(addon.sectionType){case"counter":return templateAddonSectionCounter(parentId,addon.section);case"multipleSelect":return templateAddonSectionMultipleSelect(parentId,addon.section);default:return templateAddonSectionCounter(parentId,addon.section)}}function getAddonTemplateByItemName(parentId,itemName){if(!dictAddonsByName.has(itemName)){return""}const addon=dictAddonsByName.get(itemName);switch(addon.sectionType){case"counter":return templateAddonCounter(parentId,addon);case"multipleSelect":return templateAddonMultipleSelect(parentId,addon);default:return templateAddonCounter(parentId,addon)}}function templateAddonSectionMultipleSelect(parentId,sectionName){return`
    <section id="${parentId}AddonsSection${sectionName}">
      <h5 class="bg-body-secondary text-purple p-3 shadow-sm border-bottom m-0">${sectionName}</h5>

      <div  class="row justify-content-start w-100 px-0 py-lg-2 py-xl-2 px-lg-2 px-xl-2 m-0 container" id="${parentId}AddonsSectionItems${sectionName}">
      </div>
    </section>
  `}function templateAddonMultipleSelect(parentId,addon){return`
    <div ${addon.infoTitle?"title='"+addon.infoTitle+"'":""} class="col-12 col-lg-3 col-xl-3 py-3 px-2 justify-content-between align-items-center">
      <input type="checkbox" ${addon.checked?"checked":""} class="btn-check" id="${parentId}AddonsItem${addon.id}" autocomplete="off">
      <label class="btn btn-outline-success border border-1 bg-gradient py-3 py-lg-2 py-xl-2 px-3 d-flex align-items-center justify-content-between m-0 rounded-0" for="${parentId}AddonsItem${addon.id}">
        <h4 class="fw-bolder col-5 text-wrap d-block d-lg-none d-xl-none">${addon.displayName??addon.name}</h4>
        <span class="fw-bolder col-5 text-wrap d-none d-lg-block d-xl-block">${addon.displayName??addon.name}</span>

        <div class="vr d-none d-lg-block d-xl-block mx-2 my-0"></div>
        ${templateAddonImgMultipleSelect(addon.img)}
      </label>
    </div>
  `}function templateAddonImgMultipleSelect(addonImg){if(!addonImg){return""}return`
    <div class="col-4 col-lg-6 col-xl-6 p-lg-3 p-xl-3 d-flex justify-content-center">
      <div class="border bg-light d-flex">
        <img src="${addonImg}" class="img-fluid p-2">
      </div>
    </div>
  `}function templateAddonSectionCounter(parentId,sectionName){return`
    <section id="${parentId}AddonsSection${sectionName}">
      <h5 class="bg-body-secondary text-purple p-3 shadow-sm border-bottom m-0">${sectionName}</h5>

      <ul  class="list-group list-group-flush" id="${parentId}AddonsSectionItems${sectionName}">
      </ul>
    </section>
  `}function templateAddonCounter(parentId,addon){return`
      <li class="list-group-item py-4 px-2 d-flex justify-content-between align-items-center" id="${parentId}AddonsItem${addon.id}">
        <span class="position-relative d-flex align-items-center">
            <span class="addon-price badge rounded-0 bg-success p-1 border shadow">${formatItemPrice(addon.price)}</span>
            <div class="vr mx-2 p-0"></div>
            ${addon.displayName??addon.name}
          </span>
        <span>${templateItemCountRegulator(parentId,addon.id,false)}</span>
      </li>
  `}function getDictCountByAddon(arrAddons){const dict=new Map;arrAddons.forEach(item=>{if(dict.has(item.name)){dict.set(item.name,dict.get(item.name)+1)}else{dict.set(item.name,1)}});return dict}function formatDictCountByAddon(amountByAddon){return[...amountByAddon.entries()].reduce((accumulator,[itemName,itemCount],index,array)=>{const comma=index<array.length-1?", ":"";return accumulator+`${itemCount}x ${itemName}${comma}`},"")}function formatFillings(itemFillings){const tmpFillings=Array.from(itemFillings).map(i=>i.name);if(tmpFillings.length===0)return"";if(tmpFillings.length===1)return tmpFillings[0];const allButLast=tmpFillings.slice(0,-1).join(", ");const last=tmpFillings[tmpFillings.length-1];return`${allButLast} e ${last}`}function removeItemFromBagById(itemId){BagBuilder.removeItemById(itemId)}function templateItemOffcanvasBagInfo(item,modalToTriggerId="modalItemEdit"){const amountByAddon=getDictCountByAddon(item.addons);let strItemAddons="";if(item.addons&&item.addons.length>0){strItemAddons=formatDictCountByAddon(amountByAddon)}else{strItemAddons="Sem adicionais."}return`        
    <li id="bagInfoItem${item.id}" class="list-group-item">
      <div class="card border-0">
        <div class="card-body">
          <h6 class="card-title fw-bold text-body-secondary row justify-content-between">
            <span class="col-6 text-start m-0 p-0"><small><b><i id="bagInfoItemAmount${item.id}">${item.amount}</i>x</b></small id="bagInfoItemName${item.id}"> ${item.details.name} <br> <small>${formatFillings(item.fillings)}</small></span>

            <span class="col-5 text-end"><small id="bagInfoItemPrice${item.id}">${formatItemPrice(item.price)}</small></span>
          </h6>
          <span id="bagInfoItemAddons${item.id}" class="card-subtitle mb-2 text-body-tertiary">${strItemAddons}</span>

          <div class="card-footer bg-transparent border-0 d-flex justify-content-start px-0 gap-5">
            <button type="button" onclick="addOrderDetailsForEditItem('${modalToTriggerId}', '${item.id}')" class="btn border-0 fw-bold text-pink px-0"  data-bs-toggle="modal" data-bs-target="#${modalToTriggerId}">Editar</button>

            <button onclick="removeItemFromBagById('${item.id}')" type="button" class="btn border-0 fw-bold text-body-tertiary px-0">
              <small>Remover</small>
            </button>
          </div>
        </div>
      </div>
    </li>`}function setInstagramLink(anchorElement){var userAgent=navigator.userAgent||navigator.vendor||window.opera;if(/android/i.test(userAgent)){anchorElement.href="intent://instagram.com/_u/pacaidelivery1/#Intent;package=com.instagram.android;scheme=https;end"}else if(/iPad|iPhone|iPod/.test(userAgent)&&!window.MSStream){anchorElement.href="instagram://user?username=pacaidelivery1"}else{anchorElement.setAttribute("target","_blank");anchorElement.href="https://www.instagram.com/pacaidelivery1"}}function cleanAddressForm(){const inputDeliveryInfoStreet=document.getElementById("inputDeliveryInfoStreet");const inputDeliveryInfoName=document.getElementById("inputDeliveryInfoName");const inputDeliveryInfoPhone=document.getElementById("inputDeliveryInfoPhone");if(!inputDeliveryInfoStreet||!inputDeliveryInfoName||!inputDeliveryInfoPhone){return}inputDeliveryInfoStreet.value="";inputDeliveryInfoName.value="";inputDeliveryInfoPhone.value=""}function tryUnlockPaymentInfo(){if(!isInputValueValid("inputDeliveryInfoStreet")){alert("Por favor, insira um endereço válido para que a gente entregue o pedido sem problemas.");return}if(!isInputValueValid("inputDeliveryInfoName")){alert("Por favor, insira o nome da pessoa que vai receber o pedido no local.");return}if(!isInputValueValid("inputDeliveryInfoPhone",{checkStringEmptyWithoutDigits:false})){alert("Por favor, insira um telefone válido para entrarmos em contato.");return}const inputDeliveryInfoStreet=document.getElementById("inputDeliveryInfoStreet");const inputDeliveryInfoName=document.getElementById("inputDeliveryInfoName");const inputDeliveryInfoPhone=document.getElementById("inputDeliveryInfoPhone");const addressInfo={street:inputDeliveryInfoStreet.value,receiverName:inputDeliveryInfoName.value,receiverPhone:inputDeliveryInfoPhone.value};const inputDeliveryInfoSaveAddress=document.getElementById("inputDeliveryInfoSaveAddress");if(inputDeliveryInfoSaveAddress&&inputDeliveryInfoSaveAddress.checked){savedAddress(addressInfo)}}function getSavedAddresses(){return localStorage.getItem("savedAddresses")?JSON.parse(localStorage.getItem("savedAddresses")):[]}function savedAddress(addressInfo){const cacheSavedAddresses=getSavedAddresses();let savedAddresses=cacheSavedAddresses&&cacheSavedAddresses.length>0?[...cacheSavedAddresses,addressInfo]:[addressInfo];localStorage.setItem("savedAddresses",`${JSON.stringify(savedAddresses)}`)}function isInputValueValid(inputId,options={checkStringEmptyWithoutDigits:true}){const inputDeliveryInfoStreet=document.getElementById(inputId);if(!inputDeliveryInfoStreet){return false}const valueTrimmed=inputDeliveryInfoStreet.value.replaceAll(" ","");const valueWithoutDigits=valueTrimmed.replaceAll(/\d/g,"");return valueTrimmed.length>0&&(!options.checkStringEmptyWithoutDigits||valueWithoutDigits.length>0)}function formatPhoneNumber(inputText){const cleanNumber=inputText.replace(/\D/g,"");let result;if(cleanNumber.length<=10){const regex=/^(\d{2})(\d{4})(\d{0,4})$/;result=cleanNumber.replace(regex,"($1) $2-$3")}else{const regex=/^(\d{2})(\d{5})(\d{0,4})$/;result=cleanNumber.replace(regex,"($1) $2-$3")}return result}function setInputForcePhoneNumberFormat(inputElement){inputElement.addEventListener("input",function(){let phoneInput=this.value;const cleanPhoneInput=phoneInput.replace(/\D/g,"");if(cleanPhoneInput.length>11){phoneInput=cleanPhoneInput.slice(0,11)}let phoneNumberFormatted=formatPhoneNumber(phoneInput);if(phoneNumberFormatted.length===10){phoneNumberFormatted=phoneNumberFormatted.replaceAll("-","")}this.value=phoneNumberFormatted})}function setWhatsappLink(anchorElement){var userAgent=navigator.userAgent||navigator.vendor||window.opera;var phoneNumber="+55"+"84992100295";var message=anchorElement.getAttribute("whatsapp-message")??"Olá!";if(/android/i.test(userAgent)){anchorElement.href="https://wa.me/"+phoneNumber+"?text="+encodeURIComponent(message)}else if(/iPad|iPhone|iPod/.test(userAgent)&&!window.MSStream){anchorElement.href="whatsapp://send?phone="+phoneNumber+"&text="+encodeURIComponent(message)}else{anchorElement.setAttribute("target","_blank");anchorElement.href="https://api.whatsapp.com/send?phone="+phoneNumber+"&text="+encodeURIComponent(message)}}function addCurrentItem(){BagBuilder.addItem(modalItemSelectItemBuilder.buildAndReset())}let modalItemSelectItemBuilder=new ItemBuilder({onInit:function(){const buttonDecreaseItemCount=document.getElementById("modalItemSelectDecreaseItemCount");const buttonIncreaseItemCount=document.getElementById("modalItemSelectIncreaseItemCount");buttonDecreaseItemCount.addEventListener("click",()=>this.amount--);buttonIncreaseItemCount.addEventListener("click",()=>this.amount++)},onAmountChange:function(){resetModalItemCount("modalItemSelect",this);resetModalItemPrice("modalItemSelect",this)}});let modalItemEditItemBuilder=new ItemBuilder({onInit:function(){const buttonDecreaseItemCount=document.getElementById("modalItemEditDecreaseItemCount");const buttonIncreaseItemCount=document.getElementById("modalItemEditIncreaseItemCount");buttonDecreaseItemCount.addEventListener("click",()=>this.amount--);buttonIncreaseItemCount.addEventListener("click",()=>this.amount++)},onAmountChange:function(){resetModalItemCount("modalItemEdit",this);resetModalItemPrice("modalItemEdit",this)},onItemChange:function(){setModalCurrentItem("modalItemEdit",this)}});function initStore(){document.querySelectorAll(".whatsapp-link").forEach(el=>setWhatsappLink(el));document.querySelectorAll(".instagram-link").forEach(el=>setInstagramLink(el));setHTMLProducts();setHTMLAddonsSections("modalItemSelect",modalItemSelectItemBuilder);setHTMLAddonsSections("modalItemEdit",modalItemEditItemBuilder)}window.addEventListener("load",()=>{setupModalBuildItem("modalItemSelect",modalItemSelectItemBuilder);setupModalBuildItem("modalItemEdit",modalItemEditItemBuilder);makeInputSearchShowcase("inputBuscaDesktop");makeInputSearchShowcase("inputBuscaMobile");const inputDeliveryInfoPhone=document.getElementById("inputDeliveryInfoPhone");if(inputDeliveryInfoPhone){setInputForcePhoneNumberFormat(inputDeliveryInfoPhone)}const buttonCompleteOrder=document.getElementById("buttonCompleteOrder");if(buttonCompleteOrder){const offcanvasCartOrder=new bootstrap.Offcanvas("#offcanvasCartOrder");buttonCompleteOrder.addEventListener("click",()=>{offcanvasCartOrder.hide();cleanAddressForm()})}const modalCompleteOrder=document.getElementById("modalCompleteOrder");if(modalCompleteOrder){modalCompleteOrder.addEventListener("hidden.bs.modal",()=>{cleanAddressForm()})}const modalCompleteOrderPaymentTab=document.getElementById("payment-tab");if(modalCompleteOrderPaymentTab){modalCompleteOrderPaymentTab.addEventListener("click",function(){if(this.disabled){alert("Insira um endereço manualmente, ou selecione um endereço salvo, para prosseguir para a forma de pagamento.")}})}initStore()});